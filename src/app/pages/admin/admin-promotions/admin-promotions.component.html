<section class="admin-page">
  <header class="admin-page__header">
    <div>
      <p class="admin-page__eyebrow">Промо и скидки</p>
      <h2>Промоакции</h2>
      <p class="admin-page__subtitle">Управляйте сезонными кампаниями, скидками и промокодами.</p>
    </div>
    <button class="admin-button admin-button--primary admin-button--create" type="button" (click)="toggleCreateForm()">
      {{ showCreateForm ? 'Скрыть форму' : 'Новая акция' }}
    </button>
  </header>

  <article class="admin-card admin-card--form" *ngIf="showCreateForm">
    <div class="admin-card__header">
      <h3>Новая акция</h3>
      <span class="admin-pill">Черновик</span>
    </div>
    <form class="admin-form" (ngSubmit)="savePromotion()">
      <label>
        Название акции
        <input type="text" name="name" [(ngModel)]="form.name" />
      </label>
      <label>
        Сегмент товаров
        <input type="text" name="scope" [(ngModel)]="form.scope" />
      </label>
      <div class="admin-form__row">
        <label>
          Размер скидки
          <input type="text" name="discount" [(ngModel)]="form.discount" />
        </label>
        <label>
          Даты
          <input type="text" name="period" [(ngModel)]="form.period" />
        </label>
      </div>
      <label>
        Статус
        <input type="text" name="status" [(ngModel)]="form.status" />
      </label>
      <div class="admin-form__actions">
        <button class="admin-button admin-button--primary" type="submit">Сохранить</button>
        <button class="admin-button" type="button" (click)="resetForm()">Сбросить</button>
      </div>
    </form>
  </article>

  <div class="admin-grid">
    <p class="admin-empty" *ngIf="isLoading">Загрузка акций...</p>
    <ng-container *ngFor="let promo of promotions">
      <article class="promo-card">
        <div class="promo-card__header">
          <h3>{{ promo.name }}</h3>
          <span class="promo-card__status">{{ promo.status }}</span>
        </div>
        <p>{{ promo.scope }}</p>
        <div class="promo-card__meta">
          <span>{{ promo.discount }}</span>
          <span>{{ promo.period }}</span>
        </div>
        <div class="promo-card__actions">
          <button class="admin-button" type="button" (click)="selectPromotion(promo)">Редактировать</button>
          <button class="admin-button" type="button" (click)="deletePromotion(promo)">Удалить</button>
        </div>
      </article>

      <article class="admin-card admin-card--inline" *ngIf="selectedPromotion?.id === promo.id">
        <div class="admin-card__header">
          <h3>Настройка акции</h3>
        <span class="admin-pill">ID {{ selectedPromotion?.id }}</span>
        </div>
        <form class="admin-form" (ngSubmit)="savePromotion()">
          <label>
            Название акции
            <input type="text" name="editName" [(ngModel)]="form.name" />
          </label>
          <label>
            Сегмент товаров
            <input type="text" name="editScope" [(ngModel)]="form.scope" />
          </label>
          <div class="admin-form__row">
            <label>
              Размер скидки
              <input type="text" name="editDiscount" [(ngModel)]="form.discount" />
            </label>
            <label>
              Даты
              <input type="text" name="editPeriod" [(ngModel)]="form.period" />
            </label>
          </div>
          <label>
            Статус
            <input type="text" name="editStatus" [(ngModel)]="form.status" />
          </label>
          <div class="admin-form__actions">
            <button class="admin-button admin-button--primary" type="submit">Сохранить</button>
            <button class="admin-button" type="button" (click)="resetForm()">Сбросить</button>
          </div>
        </form>
      </article>
    </ng-container>
  </div>
</section>
