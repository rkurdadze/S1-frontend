<header class="header">
    <div class="header__bar">

        <div class="header__controls">
            <button
                    class="navbar-toggler"
                    type="button"
                    [attr.aria-label]="'aria.toggleMenu' | translate"
                    aria-controls="headerNav"
                    aria-expanded="false"
                    (click)="toggleMenu()">
                <span class="burger">
                    <span></span>
                    <span></span>
                    <span></span>
                </span>
            </button>
        </div>


        <div class="brand">
            <div class="brand__logo">
                <img src="assets/imgs/studio101-logo.png" [alt]="'aria.alt_logo' | translate"/>
            </div>
            <div class="brand__text">
                <span class="brand__mark">Studio101</span>
                <span class="brand__tag">{{ 'brand.tagline' | translate }}</span>
            </div>
        </div>

        <nav class="header__nav" aria-label="Main">
            <a
              *ngFor="let item of headerNavItems"
              class="header__nav-link"
              [attr.href]="item.fragment ? ('#' + item.fragment) : item.route"
              (click)="onNavItemSelect($event, item)">
                <span>{{ item.key | translate }}</span>
            </a>
        </nav>

        <div class="header__actions">

            <div class="header__controls">
                <div class="lang-dropdown" [class.is-open]="languageDropdownOpen">
                    <button
                            type="button"
                            class="lang-dropdown__toggle"
                            [attr.aria-label]="currentLanguageOption.label"
                            aria-haspopup="listbox"
                            [attr.aria-expanded]="languageDropdownOpen"
                            (click)="toggleLanguageDropdown($event)">
                        <span class="lang-dropdown__flag">{{ currentLanguageOption.flag }}</span>
                    </button>
                    <ul
                            class="lang-dropdown__menu"
                            *ngIf="languageDropdownOpen"
                            role="listbox"
                            aria-label="Language switcher">
                        <li *ngFor="let language of languages">
                            <button
                                    *ngIf="language.code !== currentLanguage"
                                    type="button"
                                    class="lang-dropdown__option"
                                    role="option"
                                    (click)="onLanguageSelect(language.code)">
                                <span class="lang-dropdown__flag">{{ language.flag }}</span>
                            </button>
                        </li>

                    </ul>
                </div>
            </div>

            <div class="search">
                <input
                  type="text"
                  [placeholder]="'search.placeholder' | translate"
                  [attr.aria-label]="'search.placeholder' | translate"/>
                <span class="search__hint">{{ 'search.hint' | translate }}</span>
            </div>

            <div class="actions-tray">
                <div class="icons icons--actions" role="group">
                    <button class="icon-btn" [attr.aria-label]="'aria.favorites' | translate" (click)="addToFavorites()">
                        <span class="material">‚ô°</span>
                    </button>
                    <a class="icon-btn" [attr.aria-label]="'aria.cart' | translate" [routerLink]="['/cart']">
                        <span class="material">üõç</span>
                        <span class="badge">{{ cartCount$ | async }}</span>
                    </a>

                    @if (isLoggedIn$ | async) {
                        <div class="dropdown" (click)="$event.stopPropagation()">
                            <img
                                    [src]="userIcon"
                                    [alt]="'aria.alt_profile' | translate"
                                    class="user-avatar dropdown-toggle"
                                    id="userDropdown"
                                    [attr.aria-expanded]="isProfileMenuOpen"
                                    (click)="toggleProfileMenu($event)"
                            />

                            <div
                              class="dropdown-menu dropdown-menu-end dropdown-menu--profile"
                              aria-labelledby="userDropdown"
                              *ngIf="isProfileMenuOpen"
                            >
                                <app-profile-menu
                                  [items]="profileMenuItems"
                                  [isLoggedIn]="isLoggedIn"
                                  [isAdmin]="isAdmin"
                                  (selectItem)="onProfileMenuSelect($event)">
                                </app-profile-menu>
                            </div>
                        </div>
                    } @else {
                        <app-login-button></app-login-button>
                    }
                </div>

            </div>
        </div>
    </div>
</header>
